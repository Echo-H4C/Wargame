# 1. 웹페이지

![image](./images/1_수정.png)

웹페이지에 접근하면 Hello 라는 문자열이 출력된다. 이 이외에 다른 기능은 보이지 않았으며 웹페이지의 구조와 취약점을 자세히 파악하기 위해 제공된 소스코드를 분석하였다.

# 2. 소스코드 분석

파일은 Dockerfile과 app.py 파일이 주어졌으며 app.py 파일은 admin, main 두 디렉터리에 각각 존재하였다. 일단 먼저 main 디렉터리의 app.py 파일부터 분석하였다.

![image](./images/2_수정.png)

특별한 기능은 존재하지 않지만 path에 입력된 내용을 s 변수에 저장한 후 s 변수 값이 포함된 문자열을 render_template_string() 함수를 호출하여 렌더링한다. 해당 함수의 경우 사용자의 입력 값이 포함되면 SSTI 취약점이 발생할 수 있는 함수이므로 사용을 지양하는 것이 좋다. SSTI 취약점이 발생하는지를 테스트해보기 위해 {{config}} 템플릿 구문을 입력해보았다.

![image](./images/3_수정.png)

입력한 템플릿 구문이 실행되어 웹 애플리케이션 설정 내용이 출력되므로 이 웹페이지에는 SSTI 취약점이 존재함을 알 수 있다.

추가로 RCE 취약점을 발생시킬 수 있는 템플릿 구문을 입력하여 시스템 명령('ls')을 실행시킬 수 있는 것을 확인하였다.

![image](./images/4_수정.png)

시스템 명령을 실행시킬 수 있는 것을 확인하였으므로 flag 파일을 출력하기 위해 flag 파일의 위치를 파악하기 위한 Dockerfile 파일을 분석하였다.

![image](./images/5_수정.png)

Dockerfile의 내용을 보면 flag 파일을 / 디렉터리에 복사한 것을 알 수 있다. 따라서 cat /flag 명령을 실행하면 flag를 획득할 수 있을 것이라고 판단하여 cat /flag 명령을 실행시키기 위한 템플릿 구문을 입력하였다.

![image](./images/6_수정.png)
